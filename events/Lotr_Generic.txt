###########################
# Generic LOTR Events
###########################

add_namespace = lotr_generic
add_namespace = lotr_gambler # investment gambler advisor


# Claim state with chance of working out a deal
country_event = {
	id = lotr_generic.1
	title = lotr_generic.1.t
	desc = lotr_generic.1.d
	picture = GFX_report_event_alliance

	is_triggered_only = yes

	# Outrage response / do nothing about it
	option = {
		name = lotr_generic.1.a

		ai_chance = {
			base = 10
			modifier = {
		        add = 10
		        strength_ratio = {
				    tag = FROM
				    ratio > 1
				}
		    }
		}

		event_target:target_claimed_state = {
        	add_claim_by = FROM
        }
	}
	# Try to work out a deal where we get to keep the territory
	option = {
		name = lotr_generic.1.b

		ai_chance = {
			base = 10
			modifier = {
		        add = 10
		        strength_ratio = {
				    tag = FROM
				    ratio < 1.5
				}
		    }
		}

		event_target:target_claimed_state = {
        	add_claim_by = FROM
        }
        custom_effect_tooltip = lotr_generic.1.b_tooltip
        hidden_effect = {
			FROM = { country_event = { id = lotr_generic.2 days = 1 random_days = 1 } }
		}
	}
	# Hand it over for a non-agression pact
	option = {
		name = lotr_generic.1.c

		ai_chance = {
			base = 4
			modifier = {
		        factor = 0
		        strength_ratio = {
				    tag = FROM
				    ratio > 1
				}
		    }
		}

		effect_tooltip = {

			FROM = {
				transfer_state = event_target:target_claimed_state
			}
			diplomatic_relation = {
			    country = FROM
			    relation = non_aggression_pact
			    active = yes
			}
		}
		hidden_effect = {
			FROM = { country_event = { id = lotr_generic.5 days = 1 random_days = 1 } }
		}
	}
}

# Attempt to work out a deal regarding a claimed state
country_event = {
	id = lotr_generic.2
	title = lotr_generic.2.t
	desc = lotr_generic.2.d
	picture = GFX_report_event_alliance

	is_triggered_only = yes

	# Accept deal
	option = {
		name = lotr_generic.2.a

		ai_chance = {
			base = 10
			modifier = {
		        add = 10
		        strength_ratio = {
				    tag = FROM
				    ratio > 1
				}
		    }
		}

		event_target:target_claimed_state = {
        	remove_claim_by = ROOT
        }
        diplomatic_relation = {
		    country = FROM
		    relation = non_aggression_pact
		    active = yes
		}
		FROM = { give_resource_rights = { receiver = ROOT state = event_target:target_claimed_state } }

		hidden_effect = {
        	FROM = { country_event = { id = lotr_generic.3 days = 1 random_days = 1 } }
    	}
	}
	# Decline Deal
	option = {
		name = lotr_generic.2.b

		ai_chance = {
			base = 10
			modifier = {
		        factor = 0.15
		        strength_ratio = {
				    tag = FROM
				    ratio < 1
				}
		    }
		}

		effect_tooltip = {
			FROM = {
				add_political_power = 100
				add_war_support = 0.1
			}
		}

		hidden_effect = {
			FROM = { country_event = { id = lotr_generic.4 days = 1 random_days = 1 } }
		}
	}
}

# Claim-deal accepted
country_event = {
	id = lotr_generic.3
	title = lotr_generic.3.t
	desc = lotr_generic.3.d
	picture = GFX_report_event_alliance

	is_triggered_only = yes

	# Ok
	option = {
		name = lotr_generic.3.a

		effect_tooltip = {
	        event_target:target_claimed_state = {
	        	remove_claim_by = FROM
	        }
	        diplomatic_relation = {
			    country = FROM
			    relation = non_aggression_pact
			    active = yes
			}
	    }
	}
}

# Claim-deal declined
country_event = {
	id = lotr_generic.4
	title = lotr_generic.4.t
	desc = lotr_generic.4.d
	picture = GFX_report_event_alliance

	is_triggered_only = yes

	# Ok
	option = {
		name = lotr_generic.4.a

		add_political_power = 100
		add_war_support = 0.1
	}
}

# Hand over a claimed state for a NA-pact
country_event = {
	id = lotr_generic.5
	title = lotr_generic.5.t
	desc = lotr_generic.5.d
	picture = GFX_report_event_alliance

	is_triggered_only = yes

	option = { # Okay
		name = lotr_generic.5.a

		transfer_state = event_target:target_claimed_state

		diplomatic_relation = {
		    country = FROM
		    relation = non_aggression_pact
		    active = yes
		}
	}
}

# Investment gambler good outcome
country_event = {
	id = lotr_gambler.1
	title = lotr_gambler.1.t
	desc = lotr_gambler.1.d
	picture = GFX_report_event_alliance

	is_triggered_only = yes

	option = { # Okay
		name = lotr_gambler.1.a
		ai_chance = { base = 3 }
	}

	option = { # Give him a raise
		name = lotr_gambler.1.b
		ai_chance = { base = 1 }

		add_timed_idea = {
		    idea = minor_expense
		    days = 35
		}

		set_country_flag = investment_gambler_raise
		custom_effect_tooltip = investment_gambler_raise_effect_tooltip
	}
}

# Investment gambler bad outcome
country_event = {
	id = lotr_gambler.2
	title = lotr_gambler.2.t
	desc = lotr_gambler.2.d
	picture = GFX_report_event_alliance

	is_triggered_only = yes

	option = { # Okay
		name = lotr_gambler.2.a
		ai_chance = { base = 10 }


	}

	option = { # Attempt to mitigate the situation
		name = lotr_gambler.2.b
		ai_chance = { base = 1 }

		add_political_power = -150

		random_list = {
		    15 = {
		        subtract_from_variable = {
				    var = THIS.investment_gambler_factor
				    value = 0.02
				    tooltip = lotr_gambler.2.b.tooltip
				}
		    }
		    10 = {
		    }
		}
	}

	option = { # Off with his head!
		name = lotr_gambler.2.c
		ai_chance = { base = 1 }

		remove_ideas_with_trait = investment_gambler
		set_country_flag = investment_gambler_killed
	}
}

# Send delegation to country
country_event = {
	id = lotr_generic.6
	title = lotr_generic.6.t
	desc = lotr_generic.6.d
	picture = GFX_report_event_alliance

	is_triggered_only = yes

	option = { # Shower them with gifts
		name = lotr_generic.6.a
		ai_chance = {
			base = 1
			modifier = {
				factor = 2
				has_opinion = {
					target = LTH
					value > 30
				}
			}
			modifier = {
				factor = 2
				FROM = { is_going_same_path_as_root = yes }
			}
			modifier = {
				factor = 0.25
				FROM = { is_going_different_path_as_root = yes }
			}
		}
		
		add_timed_idea = {
			idea = minor_expense
			days = 60
		}
		FROM = {
			add_opinion_modifier = {
				target = ROOT
				modifier = large_increase
			}
			add_relation_modifier = {
				target = FROM
				modifier = free_license
			}
		}
	}

	option = { # Give them the common courtesies
		name = lotr_generic.6.b
		ai_chance = {
			base = 1
			modifier = {
				factor = 2
				has_opinion = {
					target = LTH
					value > 15
				}
			}
			modifier = {
				factor = 0.5
				FROM = { is_going_different_path_as_root = yes }
			}
		}
		
		add_political_power = 50
		FROM = {
			add_opinion_modifier = {
				target = ROOT
				modifier = medium_increase
			}
		}
	}

	option = { # They're not welcome here
		name = lotr_generic.6.c
		ai_chance = {
			base = 1
			modifier = {
				factor = 2
				has_opinion = {
					target = LTH
					value < 0
				}
			}
			modifier = {
				factor = 0.5
				FROM = { is_going_same_path_as_root = yes }
			}
			modifier = {
				factor = 2
				FROM = { is_going_different_path_as_root = yes }
			}
		}
		
		add_political_power = -50
		FROM = {
			add_opinion_modifier = {
				target = ROOT
				modifier = medium_decrease
			}
		}
	}
}
